(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["uploadGroup"],{"3a52":function(t,e,n){"use strict";n.r(e);var r=n("7a23"),i=function(t){return Object(r["E"])("data-v-54d15ad2"),t=t(),Object(r["C"])(),t},o={class:"content"},a={class:"topMenu_title"},s=i((function(){return Object(r["i"])("h4",{class:"title"},"好图推荐",-1)})),u={class:"swiper"},c={class:"topMenu"},l={class:"con_1"},h=i((function(){return Object(r["i"])("div",{class:"item_top"},[Object(r["i"])("div",{class:"username"},"sazkuyo"),Object(r["i"])("div",{class:"date_title"},"2021-12-19")],-1)})),f=i((function(){return Object(r["i"])("div",{class:"item_msg"},null,-1)})),p={class:"con_2"},d={class:"todo"},g=i((function(){return Object(r["i"])("div",{class:"msg"},null,-1)})),y={class:"concelltion"},v={class:"share"},b={class:"more"};function m(t,e,n,i,m,w){var k=Object(r["I"])("van-icon"),O=Object(r["I"])("van-image"),j=Object(r["I"])("van-swipe-item"),C=Object(r["I"])("van-swipe"),_=Object(r["I"])("van-list"),x=Object(r["I"])("van-pull-refresh"),I=Object(r["I"])("van-image-preview");return Object(r["B"])(),Object(r["h"])("div",o,[Object(r["i"])("div",a,[Object(r["k"])(k,{onClick:w.back,name:"arrow-left",size:"25",class:"ret"},null,8,["onClick"]),s]),Object(r["i"])("div",u,[Object(r["k"])(C,{class:"my-swipe",autoplay:3e3,"indicator-color":"white"},{default:Object(r["S"])((function(){return[(Object(r["B"])(!0),Object(r["h"])(r["a"],null,Object(r["H"])(m.prominantImgList,(function(t,e){return Object(r["B"])(),Object(r["f"])(j,{class:"swipe-item",key:e},{default:Object(r["S"])((function(){return[Object(r["k"])(O,{class:"swipe-img",fit:"scale-down",src:t,rel:"external nofollow"},null,8,["src"])]})),_:2},1024)})),128))]})),_:1})]),Object(r["i"])("div",c,[Object(r["i"])("div",{class:"topMenu-item selected",onClick:e[0]||(e[0]=function(t){return w.select(0)})},"热度倒序"),Object(r["i"])("div",{class:"topMenu-item",onClick:e[1]||(e[1]=function(t){return w.select(1)})},"时间倒序")]),Object(r["i"])("div",l,[Object(r["k"])(x,{modelValue:m.refreshing,"onUpdate:modelValue":e[3]||(e[3]=function(t){return m.refreshing=t}),onRefresh:w.onRefresh},{default:Object(r["S"])((function(){return[Object(r["k"])(_,{class:"list",loading:m.loading,"onUpdate:loading":e[2]||(e[2]=function(t){return m.loading=t}),finished:m.finished,"finished-text":"没有更多了",onLoad:w.onLoad},{default:Object(r["S"])((function(){return[(Object(r["B"])(!0),Object(r["h"])(r["a"],null,Object(r["H"])(m.imgList,(function(t,e){return Object(r["B"])(),Object(r["h"])("div",{class:"img_cell",key:e},[h,Object(r["k"])(O,{class:"img_show",fit:"scale-down","lazy-load":"",onClick:function(t){return w.showImg(e)},src:t.sm_src},null,8,["onClick","src"]),f])})),128))]})),_:1},8,["loading","finished","onLoad"])]})),_:1},8,["modelValue","onRefresh"])]),Object(r["i"])("div",p,[Object(r["k"])(x,{modelValue:m.refreshing,"onUpdate:modelValue":e[5]||(e[5]=function(t){return m.refreshing=t}),onRefresh:w.onRefresh},{default:Object(r["S"])((function(){return[Object(r["k"])(_,{class:"list",loading:m.loading,"onUpdate:loading":e[4]||(e[4]=function(t){return m.loading=t}),finished:m.finished,"finished-text":"没有更多了",onLoad:w.onLoad},{default:Object(r["S"])((function(){return[(Object(r["B"])(!0),Object(r["h"])(r["a"],null,Object(r["H"])(m.itemList,(function(t,e){return Object(r["B"])(),Object(r["h"])("div",{class:"img_cell",key:t.pid},[Object(r["k"])(O,{class:"img_show",fit:"cover","lazy-load":"",onClick:function(t){return w.showImg(e)},src:t.sm_src},null,8,["onClick","src"])])})),128))]})),_:1},8,["loading","finished","onLoad"])]})),_:1},8,["modelValue","onRefresh"])]),m.isShow?(Object(r["B"])(),Object(r["f"])(I,{key:0,class:"img_item_show","show-index":!1,"start-position":m.index,show:m.show,"onUpdate:show":e[7]||(e[7]=function(t){return m.show=t}),images:m.imgList,onChange:w.onChange,"before-close":w.closeImg},{cover:Object(r["S"])((function(){return[Object(r["i"])("div",d,[g,Object(r["i"])("div",y,[Object(r["k"])(k,{name:"like-o",size:"6vw"})]),Object(r["i"])("div",{class:"download",onClick:e[6]||(e[6]=function(){return w.down&&w.down.apply(w,arguments)})},[Object(r["k"])(k,{name:"down",size:"6vw"})]),Object(r["i"])("div",v,[Object(r["k"])(k,{name:"share-o",size:"6vw"})]),Object(r["i"])("div",b,[Object(r["k"])(k,{name:"ellipsis",size:"6vw"})])])]})),_:1},8,["start-position","show","images","onChange","before-close"])):Object(r["g"])("",!0)])}var w=n("ade3"),k=(n("fb6a"),n("ac1f"),n("1276"),n("bc3a")),O=n.n(k),j={data:function(){var t;return t={prominantImgList:["http://qiniu.ultraer.icu/0a5feb86-11c8-4064-a0d0-281fc2d2eef2.jpg","http://qiniu.ultraer.icu/8359ffb3-e963-4db9-9cd8-e9c32abad6ed.png","http://qiniu.ultraer.icu/5145d5eb-07fd-4c4d-b850-1555de715c52.png","http://qiniu.ultraer.icu/8ea5c11c-77f8-424a-9bda-7dca47ebc557.png"],cid:"",itemList:[],imgList:[],currentPage:0,loading:!1,finished:!1,show:!0,refreshing:!1,index:0,isShow:!1},Object(w["a"])(t,"imgList",[{src:"http://qiniu.ultraer.icu/45f62654-d968-4974-94cf-957c37a9be23.png",sm_src:"http://qiniu.ultraer.icu/22532533-402a-4add-be31-8f47bb31be03.png"},{src:"http://qiniu.ultraer.icu/35aaa9dc-baa9-4b87-8668-9533fdc50035.jpg",sm_src:"http://qiniu.ultraer.icu/921f6ed2-c580-46ad-8a22-f92714995e43.jpg"},{src:"http://qiniu.ultraer.icu/40787418-8910-4a3c-a206-2ad78d204c28.jpg",sm_src:"http://qiniu.ultraer.icu/1e44267c-0c9f-4b52-8938-fa9ff2f02475.jpg"},{src:"http://qiniu.ultraer.icu/c352016c-f75e-4efd-881a-d176e8a3ca20.png",sm_src:"http://qiniu.ultraer.icu/7c833a17-05a8-4ffe-af36-3af13cfc0f81.png"},{src:"http://qiniu.ultraer.icu/74a892c4-a202-4050-966c-3e8809ee173d.png",sm_src:"http://qiniu.ultraer.icu/a9b225f5-f202-4944-b259-5a376672bb5e.png"}]),Object(w["a"])(t,"index",0),Object(w["a"])(t,"value",""),t},created:function(){this.$store.state.toucherShow=!1},destroyed:function(){this.$store.state.toucherShow=!0},methods:{select:function(t){var e=document.getElementsByClassName("topMenu-item");if(e[0].classList.remove("selected"),e[1].classList.remove("selected"),e[t].classList.add("selected"),0==t){var n=document.getElementsByClassName("con_1")[0],r=document.getElementsByClassName("con_2")[0];r.style.display="none",n.style.display="block"}else{n=document.getElementsByClassName("con_1")[0],r=document.getElementsByClassName("con_2")[0];r.style.display="block",n.style.display="none"}window.scrollTo({top:0,behavior:"smooth"})},back:function(){history.back()},onLoad:function(){var t=this;null!=this.$route.query.cid?O.a.get("http://42.240.141.211/WallpaperController/queryPhoneByCategoryOrderByTime?cid="+this.cid+"&currentPage="+this.currentPage).then((function(e){if(0==e.data.length)t.loading=!1,t.finished=!0;else{for(var n=0;n<e.data.length;n++)t.itemList.push(e.data[n]),t.imgList.push(e.data[n].src);t.loading=!1,t.currentPage=t.currentPage+1,setInterval((function(){t.itemList.length>0&&(t.refreshing=!1)}),2e3)}})):(this.value=this.$route.query.category,console.log("http://42.240.141.211/WallpaperController/searchPhoneByKeyWord?keyword="+this.value+"currentPage="+this.currentPage),O.a.get("http://42.240.141.211/WallpaperController/searchPhoneByKeyWord?keyword="+this.value+"&currentPage="+this.currentPage).then((function(e){if(0==e.data.length)t.loading=!1,t.finished=!0;else{for(var n=0;n<e.data.length;n++)t.itemList.push(e.data[n]),t.imgList.push(e.data[n].src);t.loading=!1,t.currentPage=t.currentPage+1,setInterval((function(){t.itemList.length>0&&(t.refreshing=!1)}),2e3)}})))},onChange:function(t){this.currentImg=t},onRefresh:function(){this.finished=!1,this.itemList.length=0,this.loading=!0,this.currentPage=0,this.onLoad()},closeImg:function(){this.isShow=!this.isShow},showImg:function(t){return this.index=t,this.isShow=!this.isShow,!1},down:function(){console.log(this.imgList[this.index]);var t=this.imgList[this.index].split("/").slice(-1)[0];this.downloadIamge(this.imgList[this.index],t)},moveFile:function(t,e){t.moveTo(e,"newfile.txt",(function(t){plus.console.log("New Path: "+t.fullPath)}),(function(t){alert(t.message)}))},downloadIamge:function(t,e){var n=plus.downloader.createDownload(t,{method:"GET",filename:"_downloads/"+e},(function(t,e){if(200==e){var n=plus.io.convertLocalFileSystemURL(t.filename);plus.gallery.save(n,(function(){alert("保存完成")}))}else alert("下载失败")}));n.start()}}},C=(n("c53e"),n("6b0d")),_=n.n(C);const x=_()(j,[["render",m],["__scopeId","data-v-54d15ad2"]]);e["default"]=x},"66c3":function(t,e,n){},"69a0":function(t,e,n){(function(e){t.exports=e()})((function(t){"use strict";var e=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function n(t,e){var n=t[0],r=t[1],i=t[2],o=t[3];n+=(r&i|~r&o)+e[0]-680876936|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+e[1]-389564586|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+e[2]+606105819|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+e[3]-1044525330|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+e[4]-176418897|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+e[5]+1200080426|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+e[6]-1473231341|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+e[7]-45705983|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+e[8]+1770035416|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+e[9]-1958414417|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+e[10]-42063|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+e[11]-1990404162|0,r=(r<<22|r>>>10)+i|0,n+=(r&i|~r&o)+e[12]+1804603682|0,n=(n<<7|n>>>25)+r|0,o+=(n&r|~n&i)+e[13]-40341101|0,o=(o<<12|o>>>20)+n|0,i+=(o&n|~o&r)+e[14]-1502002290|0,i=(i<<17|i>>>15)+o|0,r+=(i&o|~i&n)+e[15]+1236535329|0,r=(r<<22|r>>>10)+i|0,n+=(r&o|i&~o)+e[1]-165796510|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+e[6]-1069501632|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+e[11]+643717713|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+e[0]-373897302|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+e[5]-701558691|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+e[10]+38016083|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+e[15]-660478335|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+e[4]-405537848|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+e[9]+568446438|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+e[14]-1019803690|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+e[3]-187363961|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+e[8]+1163531501|0,r=(r<<20|r>>>12)+i|0,n+=(r&o|i&~o)+e[13]-1444681467|0,n=(n<<5|n>>>27)+r|0,o+=(n&i|r&~i)+e[2]-51403784|0,o=(o<<9|o>>>23)+n|0,i+=(o&r|n&~r)+e[7]+1735328473|0,i=(i<<14|i>>>18)+o|0,r+=(i&n|o&~n)+e[12]-1926607734|0,r=(r<<20|r>>>12)+i|0,n+=(r^i^o)+e[5]-378558|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+e[8]-2022574463|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+e[11]+1839030562|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+e[14]-35309556|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+e[1]-1530992060|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+e[4]+1272893353|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+e[7]-155497632|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+e[10]-1094730640|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+e[13]+681279174|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+e[0]-358537222|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+e[3]-722521979|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+e[6]+76029189|0,r=(r<<23|r>>>9)+i|0,n+=(r^i^o)+e[9]-640364487|0,n=(n<<4|n>>>28)+r|0,o+=(n^r^i)+e[12]-421815835|0,o=(o<<11|o>>>21)+n|0,i+=(o^n^r)+e[15]+530742520|0,i=(i<<16|i>>>16)+o|0,r+=(i^o^n)+e[2]-995338651|0,r=(r<<23|r>>>9)+i|0,n+=(i^(r|~o))+e[0]-198630844|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+e[7]+1126891415|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+e[14]-1416354905|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+e[5]-57434055|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+e[12]+1700485571|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+e[3]-1894986606|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+e[10]-1051523|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+e[1]-2054922799|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+e[8]+1873313359|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+e[15]-30611744|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+e[6]-1560198380|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+e[13]+1309151649|0,r=(r<<21|r>>>11)+i|0,n+=(i^(r|~o))+e[4]-145523070|0,n=(n<<6|n>>>26)+r|0,o+=(r^(n|~i))+e[11]-1120210379|0,o=(o<<10|o>>>22)+n|0,i+=(n^(o|~r))+e[2]+718787259|0,i=(i<<15|i>>>17)+o|0,r+=(o^(i|~n))+e[9]-343485551|0,r=(r<<21|r>>>11)+i|0,t[0]=n+t[0]|0,t[1]=r+t[1]|0,t[2]=i+t[2]|0,t[3]=o+t[3]|0}function r(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function i(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t[e]+(t[e+1]<<8)+(t[e+2]<<16)+(t[e+3]<<24);return n}function o(t){var e,i,o,a,s,u,c=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(l,r(t.substring(e-64,e)));for(t=t.substring(e-64),i=t.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<i;e+=1)o[e>>2]|=t.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(n(l,o),e=0;e<16;e+=1)o[e]=0;return a=8*c,a=a.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,n(l,o),l}function a(t){var e,r,o,a,s,u,c=t.length,l=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=c;e+=64)n(l,i(t.subarray(e-64,e)));for(t=e-64<c?t.subarray(e-64):new Uint8Array(0),r=t.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],e=0;e<r;e+=1)o[e>>2]|=t[e]<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(n(l,o),e=0;e<16;e+=1)o[e]=0;return a=8*c,a=a.toString(16).match(/(.*?)(.{0,8})$/),s=parseInt(a[2],16),u=parseInt(a[1],16)||0,o[14]=s,o[15]=u,n(l,o),l}function s(t){var n,r="";for(n=0;n<4;n+=1)r+=e[t>>8*n+4&15]+e[t>>8*n&15];return r}function u(t){var e;for(e=0;e<t.length;e+=1)t[e]=s(t[e]);return t.join("")}function c(t){return/[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function l(t,e){var n,r=t.length,i=new ArrayBuffer(r),o=new Uint8Array(i);for(n=0;n<r;n+=1)o[n]=t.charCodeAt(n);return e?o:i}function h(t){return String.fromCharCode.apply(null,new Uint8Array(t))}function f(t,e,n){var r=new Uint8Array(t.byteLength+e.byteLength);return r.set(new Uint8Array(t)),r.set(new Uint8Array(e),t.byteLength),n?r:r.buffer}function p(t){var e,n=[],r=t.length;for(e=0;e<r-1;e+=2)n.push(parseInt(t.substr(e,2),16));return String.fromCharCode.apply(String,n)}function d(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==u(o("hello"))&&function(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n},"undefined"===typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function e(t,e){return t=0|t||0,t<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice=function(n,r){var i,o,a,s,u=this.byteLength,c=e(n,u),l=u;return r!==t&&(l=e(r,u)),c>l?new ArrayBuffer(0):(i=l-c,o=new ArrayBuffer(i),a=new Uint8Array(o),s=new Uint8Array(this,c,i),a.set(s),o)}}(),d.prototype.append=function(t){return this.appendBinary(c(t)),this},d.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var e,i=this._buff.length;for(e=64;e<=i;e+=64)n(this._hash,r(this._buff.substring(e-64,e)));return this._buff=this._buff.substring(e-64),this},d.prototype.end=function(t){var e,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=r.charCodeAt(e)<<(e%4<<3);return this._finish(o,i),n=u(this._hash),t&&(n=p(n)),this.reset(),n},d.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash.slice()}},d.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},d.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},d.prototype._finish=function(t,e){var r,i,o,a=e;if(t[a>>2]|=128<<(a%4<<3),a>55)for(n(this._hash,t),a=0;a<16;a+=1)t[a]=0;r=8*this._length,r=r.toString(16).match(/(.*?)(.{0,8})$/),i=parseInt(r[2],16),o=parseInt(r[1],16)||0,t[14]=i,t[15]=o,n(this._hash,t)},d.hash=function(t,e){return d.hashBinary(c(t),e)},d.hashBinary=function(t,e){var n=o(t),r=u(n);return e?p(r):r},d.ArrayBuffer=function(){this.reset()},d.ArrayBuffer.prototype.append=function(t){var e,r=f(this._buff.buffer,t,!0),o=r.length;for(this._length+=t.byteLength,e=64;e<=o;e+=64)n(this._hash,i(r.subarray(e-64,e)));return this._buff=e-64<o?new Uint8Array(r.buffer.slice(e-64)):new Uint8Array(0),this},d.ArrayBuffer.prototype.end=function(t){var e,n,r=this._buff,i=r.length,o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<i;e+=1)o[e>>2]|=r[e]<<(e%4<<3);return this._finish(o,i),n=u(this._hash),t&&(n=p(n)),this.reset(),n},d.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},d.ArrayBuffer.prototype.getState=function(){var t=d.prototype.getState.call(this);return t.buff=h(t.buff),t},d.ArrayBuffer.prototype.setState=function(t){return t.buff=l(t.buff,!0),d.prototype.setState.call(this,t)},d.ArrayBuffer.prototype.destroy=d.prototype.destroy,d.ArrayBuffer.prototype._finish=d.prototype._finish,d.ArrayBuffer.hash=function(t,e){var n=a(new Uint8Array(t)),r=u(n);return e?p(r):r},d}))},"6e8d":function(t,e,n){"use strict";n("66c3")},"8a3d":function(t,e,n){"use strict";n.r(e);var r=n("7a23"),i=function(t){return Object(r["E"])("data-v-3d8e8f7a"),t=t(),Object(r["C"])(),t},o={class:"upload"},a={class:"topBar"},s=i((function(){return Object(r["i"])("h4",{class:"title"},"好图推荐",-1)})),u={class:"content"},c={class:"upload_content"},l=i((function(){return Object(r["i"])("h4",{class:"pic_title"},"图片选择",-1)})),h={class:"tag_content"},f=i((function(){return Object(r["i"])("h4",null,"标签选择",-1)})),p=["onClick"],d=i((function(){return Object(r["i"])("h4",{class:"pop_title"},"请输入添加标签名",-1)}));function g(t,e,n,i,g,y){var v=Object(r["I"])("van-icon"),b=Object(r["I"])("van-uploader"),m=Object(r["I"])("van-popup");return Object(r["B"])(),Object(r["h"])("div",o,[Object(r["i"])("div",a,[Object(r["k"])(v,{onClick:y.back,name:"arrow-left",size:"25",class:"ret"},null,8,["onClick"]),s]),Object(r["i"])("div",u,[Object(r["i"])("div",c,[l,Object(r["k"])(b,{class:"fileUpload",modelValue:g.fileList,"onUpdate:modelValue":e[0]||(e[0]=function(t){return g.fileList=t}),multiple:"","max-count":1,"max-size":1024e4,onOversize:y.onOversize},null,8,["modelValue","onOversize"])]),Object(r["i"])("div",h,[f,(Object(r["B"])(!0),Object(r["h"])(r["a"],null,Object(r["H"])(g.tags,(function(t,e){return Object(r["B"])(),Object(r["h"])("div",{key:e,class:Object(r["t"])(g.tags_flag[e]?"tag_item_active":"tag_item"),onClick:function(t){return y.addTag(e)}},Object(r["L"])(t),11,p)})),128)),Object(r["i"])("div",{class:"tag_item",onClick:e[1]||(e[1]=function(){return y.showPopup&&y.showPopup.apply(y,arguments)})},[Object(r["k"])(v,{name:"plus"})])]),Object(r["i"])("div",{class:"btn",onClick:e[2]||(e[2]=function(){return y.upload&&y.upload.apply(y,arguments)})},"图片上传")]),Object(r["k"])(m,{onClose:y.close,show:g.show,"onUpdate:show":e[4]||(e[4]=function(t){return g.show=t}),round:"",position:"bottom",style:{height:"20%"},class:"pop"},{default:Object(r["S"])((function(){return[d,Object(r["T"])(Object(r["i"])("input",{ref:"tag_input",class:"tag_input","onUpdate:modelValue":e[3]||(e[3]=function(t){return g.current_item=t})},null,512),[[r["O"],g.current_item]])]})),_:1},8,["onClose","show"])])}n("a434"),n("b0c0"),n("e9c4"),n("fb6a"),n("ac1f"),n("1276");var y,v=n("bc3a"),b=n.n(v),m=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();(function(t){t["InvalidFile"]="InvalidFile",t["InvalidToken"]="InvalidToken",t["InvalidMetadata"]="InvalidMetadata",t["InvalidChunkSize"]="InvalidChunkSize",t["InvalidCustomVars"]="InvalidCustomVars",t["NotAvailableUploadHost"]="NotAvailableUploadHost",t["ReadCacheFailed"]="ReadCacheFailed",t["InvalidCacheData"]="InvalidCacheData",t["WriteCacheFailed"]="WriteCacheFailed",t["RemoveCacheFailed"]="RemoveCacheFailed",t["GetCanvasContextFailed"]="GetCanvasContextFailed",t["UnsupportedFileType"]="UnsupportedFileType",t["FileReaderReadFailed"]="FileReaderReadFailed",t["NotAvailableXMLHttpRequest"]="NotAvailableXMLHttpRequest",t["InvalidProgressEventTarget"]="InvalidProgressEventTarget",t["RequestError"]="RequestError"})(y||(y={}));var w=function(){function t(t,e){this.name=t,this.message=e,this.stack=(new Error).stack}return t}(),k=function(t){function e(e,n,r,i){var o=t.call(this,y.RequestError,r)||this;return o.code=e,o.reqId=n,o.isRequestError=!0,o.data=i,o}return m(e,t),e}(w),O=function(t){function e(e,n){return void 0===n&&(n=""),t.call(this,0,n,e)||this}return m(e,t),e}(k),j=function(){function t(t,e){this.runTask=t,this.limit=e,this.queue=[],this.processing=[]}return t.prototype.enqueue=function(t){var e=this;return new Promise((function(n,r){e.queue.push({task:t,resolve:n,reject:r}),e.check()}))},t.prototype.run=function(t){var e=this;this.queue=this.queue.filter((function(e){return e!==t})),this.processing.push(t),this.runTask(t.task).then((function(){e.processing=e.processing.filter((function(e){return e!==t})),t.resolve(),e.check()}),(function(e){return t.reject(e)}))},t.prototype.check=function(){var t=this,e=this.processing.length,n=this.limit-e;this.queue.slice(0,n).forEach((function(e){t.run(e)}))},t}(),C=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),_=function(){return _=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},_.apply(this,arguments)},x=function(){function t(){this.closed=!1}return t.prototype.unsubscribe=function(){this.closed||(this.closed=!0,this._unsubscribe&&this._unsubscribe())},t.prototype.add=function(t){this._unsubscribe=t},t}(),I=function(t){function e(e,n,r){var i=t.call(this)||this;return i.isStopped=!1,i.destination=e&&"object"===typeof e?e:_(_(_({},e&&{next:e}),n&&{error:n}),r&&{complete:r}),i}return C(e,t),e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype.next=function(t){!this.isStopped&&this.destination.next&&this.destination.next(t)},e.prototype.error=function(t){!this.isStopped&&this.destination.error&&(this.isStopped=!0,this.destination.error(t))},e.prototype.complete=function(t){!this.isStopped&&this.destination.complete&&(this.isStopped=!0,this.destination.complete(t))},e}(x),S=function(){function t(t){this._subscribe=t}return t.prototype.subscribe=function(t,e,n){var r=new I(t,e,n);return r.add(this._subscribe(r)),r},t}();function P(t){if(null===t||"undefined"===typeof t)return"";var e,n,r=t+"",i="",o=0;e=n=0,o=r.length;for(var a=0;a<o;a++){var s=r.charCodeAt(a),u=null;if(s<128)n++;else if(s>127&&s<2048)u=String.fromCharCode(s>>6|192,63&s|128);else if((63488&s^55296)>0)u=String.fromCharCode(s>>12|224,s>>6&63|128,63&s|128);else{if((64512&s^55296)>0)throw new RangeError("Unmatched trail surrogate at "+a);var c=r.charCodeAt(++a);if((64512&c^56320)>0)throw new RangeError("Unmatched lead surrogate at "+(a-1));s=((1023&s)<<10)+(1023&c)+65536,u=String.fromCharCode(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}null!==u&&(n>e&&(i+=r.slice(e,n)),i+=u,e=n=a+1)}return n>e&&(i+=r.slice(e,o)),i}function A(t){var e=[],n=0,r=0,i=0;t+="";while(n<t.length){r=255&t.charCodeAt(n),i=0,r<=191?(r&=127,i=1):r<=223?(r&=31,i=2):r<=239?(r&=15,i=3):(r&=7,i=4);for(var o=1;o<i;++o)r=r<<6|63&t.charCodeAt(o+n);4===i?(r-=65536,e.push(String.fromCharCode(55296|r>>10&1023)),e.push(String.fromCharCode(56320|1023&r))):e.push(String.fromCharCode(r)),n+=i}return e.join("")}function L(t){var e,n,r,i,o,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,h=0,f="",p=[];if(!t)return t;t=P(t+"");do{e=t.charCodeAt(l++),n=t.charCodeAt(l++),r=t.charCodeAt(l++),u=e<<16|n<<8|r,i=u>>18&63,o=u>>12&63,a=u>>6&63,s=63&u,p[h++]=c.charAt(i)+c.charAt(o)+c.charAt(a)+c.charAt(s)}while(l<t.length);switch(f=p.join(""),t.length%3){case 1:f=f.slice(0,-2)+"==";break;case 2:f=f.slice(0,-1)+"=";break}return f}function U(t){var e,n,r,i,o,a,s,u,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,h=0,f="",p=[];if(!t)return t;t+="";do{i=c.indexOf(t.charAt(l++)),o=c.indexOf(t.charAt(l++)),a=c.indexOf(t.charAt(l++)),s=c.indexOf(t.charAt(l++)),u=i<<18|o<<12|a<<6|s,e=u>>16&255,n=u>>8&255,r=255&u,p[h++]=64===a?String.fromCharCode(e):64===s?String.fromCharCode(e,n):String.fromCharCode(e,n,r)}while(l<t.length);return f=p.join(""),A(f)}function z(t){return t=L(t),t.replace(/\//g,"_").replace(/\+/g,"-")}function R(t){return t=t.replace(/_/g,"/").replace(/-/g,"+"),U(t)}var E,T=n("69a0"),q=n.n(T),F=function(){return F=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},F.apply(this,arguments)},B=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},H=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},D=Math.pow(1024,2);function M(t,e){var n=e*D;if(n>t.size)n=t.size;else while(t.size>1e4*n)n*=2;for(var r=[],i=Math.ceil(t.size/n),o=0;o<i;o++){var a=t.slice(n*o,o===i-1?t.size:n*(o+1));r.push(a)}return r}function N(t){return Object.keys(t).every((function(t){return 0===t.indexOf("x-qn-meta-")}))}function V(t){return Object.keys(t).every((function(t){return 0===t.indexOf("x:")}))}function G(t){return t.reduce((function(t,e){return t+e}),0)}function W(t,e,n){try{localStorage.setItem(t,JSON.stringify(e))}catch(r){n.warn(new w(y.WriteCacheFailed,"setLocalFileInfo failed: "+t))}}function K(t,e,n){var r=null==e?"_":"_key_"+e+"_";return"qiniu_js_sdk_upload_file_name_"+t+r+"size_"+n}function J(t,e){try{localStorage.removeItem(t)}catch(n){e.warn(new w(y.RemoveCacheFailed,"removeLocalFileInfo failed. key: "+t))}}function X(t,e){var n=null;try{n=localStorage.getItem(t)}catch(i){e.warn(new w(y.ReadCacheFailed,"getLocalFileInfo failed. key: "+t))}if(null==n)return null;var r=null;try{r=JSON.parse(n)}catch(o){J(t,e),e.warn(new w(y.InvalidCacheData,"getLocalFileInfo failed to parse. key: "+t))}return r}function $(t){var e="UpToken "+t;return{Authorization:e}}function Q(t){var e=$(t);return F({"content-type":"application/octet-stream"},e)}function Y(t){var e=$(t);return F({"content-type":"application/json"},e)}function Z(){if(window.XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)return new window.ActiveXObject("Microsoft.XMLHTTP");throw new w(y.NotAvailableXMLHttpRequest,"the current environment does not support.")}function tt(t){return B(this,void 0,void 0,(function(){var e,n;return H(this,(function(r){switch(r.label){case 0:return[4,et(t)];case 1:return e=r.sent(),n=new q.a.ArrayBuffer,n.append(e),[2,n.end()]}}))}))}function et(t){return new Promise((function(e,n){var r=new FileReader;r.onload=function(t){if(t.target){var r=t.target.result;e(r)}else n(new w(y.InvalidProgressEventTarget,"progress event target is undefined"))},r.onerror=function(){n(new w(y.FileReaderReadFailed,"fileReader read failed"))},r.readAsArrayBuffer(t)}))}function nt(t,e){return new Promise((function(n,r){var i=Z();if(i.open(e.method,t),e.onCreate&&e.onCreate(i),e.headers){var o=e.headers;Object.keys(o).forEach((function(t){i.setRequestHeader(t,o[t])}))}i.upload.addEventListener("progress",(function(t){t.lengthComputable&&e.onProgress&&e.onProgress({loaded:t.loaded,total:t.total})})),i.onreadystatechange=function(){var t=i.responseText;if(4===i.readyState){var e=i.getResponseHeader("x-reqId")||"";if(0!==i.status)if(200===i.status)try{n({data:JSON.parse(t),reqId:e})}catch(s){r(s)}else{var o="xhr request failed, code: "+i.status;t&&(o+=" response: "+t);var a=void 0;try{a=JSON.parse(t)}catch(u){}r(new k(i.status,e,o,a))}else r(new O("network error.",e))}},i.send(e.body)}))}function rt(t){if(t&&t.match){var e=t.match(/(^https?)/);if(!e)return"";var n=e[1];return e=t.match(/^https?:\/\/([^:^/]*):(\d*)/),e?e[2]:"http"===n?"80":"443"}return""}function it(t){if(t&&t.match){var e=t.match(/^https?:\/\/([^:^/]*)/);return e?e[1]:""}return""}function ot(t){if(!t)throw new w(y.InvalidToken,"invalid token.");var e=t.split(":");if(1===e.length)throw new w(y.InvalidToken,"invalid token segments.");var n=e.length>3?e[1]:e[0];if(!n)throw new w(y.InvalidToken,"missing assess key field.");var r=null;try{r=JSON.parse(R(e[e.length-1]))}catch(o){throw new w(y.InvalidToken,"token parse failed.")}if(null==r)throw new w(y.InvalidToken,"putPolicy is null.");if(null==r.scope)throw new w(y.InvalidToken,"scope field is null.");var i=r.scope.split(":")[0];if(!i)throw new w(y.InvalidToken,"resolve bucketName failed.");return{assessKey:n,bucketName:i,scope:r.scope}}function at(t){var e=window.URL||window.webkitURL||window.mozURL;return e.createObjectURL(t)}var st={z0:"z0",z1:"z1",z2:"z2",na0:"na0",as0:"as0",cnEast2:"cn-east-2"},ut=(E={},E[st.z0]={srcUphost:["up.qiniup.com"],cdnUphost:["upload.qiniup.com"]},E[st.z1]={srcUphost:["up-z1.qiniup.com"],cdnUphost:["upload-z1.qiniup.com"]},E[st.z2]={srcUphost:["up-z2.qiniup.com"],cdnUphost:["upload-z2.qiniup.com"]},E[st.na0]={srcUphost:["up-na0.qiniup.com"],cdnUphost:["upload-na0.qiniup.com"]},E[st.as0]={srcUphost:["up-as0.qiniup.com"],cdnUphost:["upload-as0.qiniup.com"]},E[st.cnEast2]={srcUphost:["up-cn-east-2.qiniup.com"],cdnUphost:["upload-cn-east-2.qiniup.com"]},E),ct=n("b383"),lt=function(){return lt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},lt.apply(this,arguments)},ht=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},ft=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};function pt(t,e,n){return ht(this,void 0,void 0,(function(){var r,i;return ft(this,(function(o){return r=Object(ct["stringify"])({ak:t,bucket:e}),i=n+"://api.qiniu.com/v2/query?"+r,[2,nt(i,{method:"GET"})]}))}))}function dt(t,e,n){var r=n.url,i=n.id;return r+"/buckets/"+t+"/objects/"+(null!=e?z(e):"~")+"/uploads/"+i}function gt(t,e,n,r){var i=r+"/buckets/"+e+"/objects/"+(null!=n?z(n):"~")+"/uploads";return nt(i,{method:"POST",headers:$(t)})}function yt(t,e,n,r,i){var o=ot(t).bucketName,a=dt(o,e,r)+"/"+n,s=Q(t);return i.md5&&(s["Content-MD5"]=i.md5),nt(a,lt(lt({},i),{method:"PUT",headers:s}))}function vt(t,e,n,r){var i=ot(t).bucketName,o=dt(i,e,n);return nt(o,lt(lt({},r),{method:"POST",headers:Y(t)}))}function bt(t,e,n){return nt(t,lt({method:"POST",body:e},n))}var mt=function(){return mt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},mt.apply(this,arguments)},wt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},kt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Ot=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},jt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Ot(arguments[e]));return t},Ct=4,_t=[0,502,503,504,599],xt=jt(_t,[612]),It=Math.pow(1024,3),St=function(){function t(t,e,n,r){this.hostPool=n,this.logger=r,this.aborted=!1,this.retryCount=0,this.xhrList=[],this.config=t.config,r.info("config inited.",this.config),this.putExtra=mt({fname:""},t.putExtra),r.info("putExtra inited.",this.putExtra),this.key=t.key,this.file=t.file,this.token=t.token,this.onData=e.onData,this.onError=e.onError,this.onComplete=e.onComplete;try{var i=ot(this.token);this.bucketName=i.bucketName,this.assessKey=i.assessKey}catch(o){r.error("get putPolicy from token failed.",o),this.onError(o)}}return t.prototype.checkAndUpdateUploadHost=function(){return wt(this,void 0,void 0,(function(){var t;return kt(this,(function(e){switch(e.label){case 0:return this.logger.info("get available upload host."),[4,this.hostPool.getUp(this.assessKey,this.bucketName,this.config.upprotocol)];case 1:if(t=e.sent(),null==t)throw new w(y.NotAvailableUploadHost,"no available upload host.");return null!=this.uploadHost&&this.uploadHost.host!==t.host?this.logger.warn("host switches from "+this.uploadHost.host+" to "+t.host+"."):this.logger.info("use host "+t.host+"."),this.uploadHost=t,[2]}}))}))},t.prototype.checkAndUnfreezeHost=function(){this.logger.info("check unfreeze host."),null!=this.uploadHost&&this.uploadHost.isFrozen()&&(this.logger.warn(this.uploadHost.host+" will be unfrozen."),this.uploadHost.unfreeze())},t.prototype.checkAndFreezeHost=function(t){this.logger.info("check freeze host."),t instanceof k&&null!=this.uploadHost&&_t.includes(t.code)&&(this.logger.warn(this.uploadHost.host+" will be temporarily frozen."),this.uploadHost.freeze())},t.prototype.handleError=function(t){this.logger.error(t.message),this.onError(t)},t.prototype.putFile=function(){return wt(this,void 0,void 0,(function(){var t,e,n,r,i,o;return kt(this,(function(a){switch(a.label){case 0:if(this.aborted=!1,this.putExtra.fname||(this.logger.info("use file.name as fname."),this.putExtra.fname=this.file.name),this.file.size>1e4*It)return this.handleError(new w(y.InvalidFile,"file size exceed maximum value 10000G")),[2];if(this.putExtra.customVars&&!V(this.putExtra.customVars))return this.handleError(new w(y.InvalidCustomVars,"customVars key should start width x:")),[2];if(this.putExtra.metadata&&!N(this.putExtra.metadata))return this.handleError(new w(y.InvalidMetadata,"metadata key should start with x-qn-meta-")),[2];a.label=1;case 1:return a.trys.push([1,4,,5]),this.uploadAt=(new Date).getTime(),[4,this.checkAndUpdateUploadHost()];case 2:return a.sent(),[4,this.run()];case 3:return t=a.sent(),this.onComplete(t.data),this.checkAndUnfreezeHost(),this.sendLog(t.reqId,200),[2];case 4:return e=a.sent(),this.logger.error(e),this.clear(),e instanceof k&&(n=this.aborted?"":e.reqId,r=this.aborted?-2:e.code,this.sendLog(n,r),this.checkAndFreezeHost(e),i=++this.retryCount<=this.config.retryCount,o=!this.aborted&&xt.includes(e.code),o&&i)?(this.logger.warn("error auto retry: "+this.retryCount+"/"+this.config.retryCount+"."),this.putFile(),[2]):(this.onError(e),[3,5]);case 5:return[2]}}))}))},t.prototype.clear=function(){this.logger.info("start cleaning all xhr."),this.xhrList.forEach((function(t){t.onreadystatechange=null,t.abort()})),this.logger.info("cleanup completed."),this.xhrList=[]},t.prototype.stop=function(){this.logger.info("stop."),this.clear(),this.aborted=!0},t.prototype.addXhr=function(t){this.xhrList.push(t)},t.prototype.sendLog=function(t,e){var n,r;this.logger.report({code:e,reqId:t,remoteIp:"",upType:"jssdk-h5",size:this.file.size,time:Math.floor(this.uploadAt/1e3),port:rt(null===(n=this.uploadHost)||void 0===n?void 0:n.getUrl()),host:it(null===(r=this.uploadHost)||void 0===r?void 0:r.getUrl()),bytesSent:this.progress?this.progress.total.loaded:0,duration:Math.floor(((new Date).getTime()-this.uploadAt)/1e3)})},t.prototype.getProgressInfoItem=function(t,e,n){return mt({size:e,loaded:t,percent:t/e*100},null==n?{}:{fromCache:n})},t}(),Pt=St,At=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Lt=function(){return Lt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},Lt.apply(this,arguments)},Ut=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},zt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}};function Rt(t){var e=/^[1-9]\d*$/;return e.test(String(t))}var Et=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return At(e,t),e.prototype.run=function(){return Ut(this,void 0,void 0,(function(){var t,e,n,r,i,o=this;return zt(this,(function(a){switch(a.label){case 0:if(this.logger.info("start run Resume."),!this.config.chunkSize||!Rt(this.config.chunkSize))throw new w(y.InvalidChunkSize,"chunkSize must be a positive integer");if(this.config.chunkSize>1024)throw new w(y.InvalidChunkSize,"chunkSize maximum value is 1024");return[4,this.initBeforeUploadChunks()];case 1:a.sent(),t=new j((function(t){return o.uploadChunk(t)}),this.config.concurrentRequestLimit),e=null,n=this.getLocalKey(),r=this.chunks.map((function(e,n){return t.enqueue({chunk:e,index:n})})),a.label=2;case 2:return a.trys.push([2,5,,6]),[4,Promise.all(r)];case 3:return a.sent(),[4,this.mkFileReq()];case 4:return e=a.sent(),[3,6];case 5:throw i=a.sent(),i instanceof k&&(612===i.code||400===i.code)&&J(n,this.logger),i;case 6:return J(n,this.logger),[2,e]}}))}))},e.prototype.uploadChunk=function(t){return Ut(this,void 0,void 0,(function(){var e,n,r,i,o,a,s,u,c,l=this;return zt(this,(function(h){switch(h.label){case 0:return e=t.index,n=t.chunk,r=this.cachedUploadedList[e],this.logger.info("upload part "+e+", cache:",r),i=this.config.checkByMD5,o=function(){l.usedCacheList[e]=!0,l.updateChunkProgress(n.size,e),l.uploadedList[e]=r,l.updateLocalCache()},r&&!i?(o(),[2]):[4,tt(n)];case 1:return a=h.sent(),this.logger.info("computed part md5.",a),r&&a===r.md5?(o(),[2]):(this.usedCacheList[e]=!1,s=function(t){l.updateChunkProgress(t.loaded,e)},u={body:n,md5:this.config.checkByServer?a:void 0,onProgress:s,onCreate:function(t){return l.addXhr(t)}},this.logger.info("part "+e+" start uploading."),[4,yt(this.token,this.key,t.index+1,this.getUploadInfo(),u)]);case 2:return c=h.sent(),this.logger.info("part "+e+" upload completed."),s({loaded:n.size,total:n.size}),this.uploadedList[e]={etag:c.data.etag,md5:c.data.md5,size:n.size},this.updateLocalCache(),[2]}}))}))},e.prototype.mkFileReq=function(){return Ut(this,void 0,void 0,(function(){var t,e,n=this;return zt(this,(function(r){switch(r.label){case 0:return t=Lt(Lt(Lt({parts:this.uploadedList.map((function(t,e){return{etag:t.etag,partNumber:e+1}})),fname:this.putExtra.fname},this.putExtra.mimeType&&{mimeType:this.putExtra.mimeType}),this.putExtra.customVars&&{customVars:this.putExtra.customVars}),this.putExtra.metadata&&{metadata:this.putExtra.metadata}),this.logger.info("parts upload completed, make file.",t),[4,vt(this.token,this.key,this.getUploadInfo(),{onCreate:function(t){return n.addXhr(t)},body:JSON.stringify(t)})];case 1:return e=r.sent(),this.logger.info("finish Resume Progress."),this.updateMkFileProgress(1),[2,e]}}))}))},e.prototype.initBeforeUploadChunks=function(){return Ut(this,void 0,void 0,(function(){var t,e,n;return zt(this,(function(r){switch(r.label){case 0:return this.uploadedList=[],this.usedCacheList=[],t=X(this.getLocalKey(),this.logger),t?[3,2]:(this.logger.info("init upload parts from api."),[4,gt(this.token,this.bucketName,this.key,this.uploadHost.getUrl())]);case 1:return e=r.sent(),this.logger.info("initd upload parts of id: "+e.data.uploadId+"."),this.uploadId=e.data.uploadId,this.cachedUploadedList=[],[3,3];case 2:n=["resume upload parts from local cache,","total "+t.data.length+" part,","id is "+t.id+"."],this.logger.info(n.join(" ")),this.cachedUploadedList=t.data,this.uploadId=t.id,r.label=3;case 3:return this.chunks=M(this.file,this.config.chunkSize),this.loaded={mkFileProgress:0,chunks:this.chunks.map((function(t){return 0}))},this.notifyResumeProgress(),[2]}}))}))},e.prototype.getUploadInfo=function(){return{id:this.uploadId,url:this.uploadHost.getUrl()}},e.prototype.getLocalKey=function(){return K(this.file.name,this.key,this.file.size)},e.prototype.updateLocalCache=function(){W(this.getLocalKey(),{id:this.uploadId,data:this.uploadedList},this.logger)},e.prototype.updateChunkProgress=function(t,e){this.loaded.chunks[e]=t,this.notifyResumeProgress()},e.prototype.updateMkFileProgress=function(t){this.loaded.mkFileProgress=t,this.notifyResumeProgress()},e.prototype.notifyResumeProgress=function(){var t=this;this.progress={total:this.getProgressInfoItem(G(this.loaded.chunks)+this.loaded.mkFileProgress,this.file.size+1),chunks:this.chunks.map((function(e,n){var r=t.usedCacheList[n];return t.getProgressInfoItem(t.loaded.chunks[n],e.size,r)})),uploadInfo:{id:this.uploadId,url:this.uploadHost.getUrl()}},this.onData(this.progress)},e}(Pt),Tt=Et,qt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Ft=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Bt=function(){function t(){this.crc=-1,this.table=this.makeTable()}return t.prototype.makeTable=function(){for(var t=new Array,e=0;e<256;e++){for(var n=e,r=0;r<8;r++)1&n?n=n>>>1^3988292384:n>>>=1;t[e]=n}return t},t.prototype.append=function(t){for(var e=this.crc,n=0;n<t.byteLength;n++)e=e>>>8^this.table[255&(e^t[n])];this.crc=e},t.prototype.compute=function(){return(-1^this.crc)>>>0},t.prototype.readAsUint8Array=function(t){return qt(this,void 0,void 0,(function(){var e;return Ft(this,(function(n){switch(n.label){case 0:return"function"!==typeof t.arrayBuffer?[3,2]:(e=Uint8Array.bind,[4,t.arrayBuffer()]);case 1:return[2,new(e.apply(Uint8Array,[void 0,n.sent()]))];case 2:return[2,new Promise((function(e,n){var r=new FileReader;r.onload=function(){null!=r.result&&"string"!==typeof r.result?e(new Uint8Array(r.result)):n()},r.readAsArrayBuffer(t)}))]}}))}))},t.prototype.file=function(t){return qt(this,void 0,void 0,(function(){var e,n,r,i,o,a;return Ft(this,(function(s){switch(s.label){case 0:return t.size<=D?(e=this.append,[4,this.readAsUint8Array(t)]):[3,2];case 1:return e.apply(this,[s.sent()]),[2,this.compute()];case 2:n=Math.ceil(t.size/D),r=0,s.label=3;case 3:return r<n?(i=r*D,o=r===n-1?t.size:i+D,[4,this.readAsUint8Array(t.slice(i,o))]):[3,6];case 4:a=s.sent(),this.append(new Uint8Array(a)),s.label=5;case 5:return r++,[3,3];case 6:return[2,this.compute()]}}))}))},t.file=function(e){var n=new t;return n.file(e)},t}(),Ht=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},t(e,n)};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Dt=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Mt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Nt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Ht(e,t),e.prototype.run=function(){return Dt(this,void 0,void 0,(function(){var t,e,n,r,i=this;return Mt(this,(function(o){switch(o.label){case 0:return this.logger.info("start run Direct."),t=new FormData,t.append("file",this.file),t.append("token",this.token),null!=this.key&&t.append("key",this.key),t.append("fname",this.putExtra.fname),this.config.checkByServer?[4,Bt.file(this.file)]:[3,2];case 1:e=o.sent(),t.append("crc32",e.toString()),o.label=2;case 2:return this.putExtra.customVars&&(this.logger.info("init customVars."),n=this.putExtra.customVars,Object.keys(n).forEach((function(e){return t.append(e,n[e].toString())})),this.logger.info("customVars inited.")),this.logger.info("formData inited."),[4,bt(this.uploadHost.getUrl(),t,{onProgress:function(t){i.updateDirectProgress(t.loaded,t.total)},onCreate:function(t){return i.addXhr(t)}})];case 3:return r=o.sent(),this.logger.info("Direct progress finish."),this.finishDirectProgress(),[2,r]}}))}))},e.prototype.updateDirectProgress=function(t,e){this.progress={total:this.getProgressInfoItem(t,e+1)},this.onData(this.progress)},e.prototype.finishDirectProgress=function(){if(!this.progress)return this.logger.warn("progress is null."),this.progress={total:this.getProgressInfoItem(this.file.size,this.file.size)},void this.onData(this.progress);var t=this.progress.total;this.progress={total:this.getProgressInfoItem(t.loaded+1,t.size)},this.onData(this.progress)},e}(Pt),Vt=Nt;function Gt(t,e,n){void 0===n&&(n=3);var r=Z();r.open("POST","https://uplog.qbox.me/log/3"),r.setRequestHeader("Content-type","application/x-www-form-urlencoded"),r.setRequestHeader("Authorization",$(t).Authorization),r.onreadystatechange=function(){4===r.readyState&&200!==r.status&&n>0&&Gt(t,e,n-1)};var i=[e.code||"",e.reqId||"",e.host||"",e.remoteIp||"",e.port||"",e.duration||"",e.time||"",e.bytesSent||"",e.upType||"",e.size||""].join(",");r.send(i)}var Wt=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},Kt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Wt(arguments[e]));return t},Jt=function(){function t(e,n,r,i){void 0===n&&(n=!0),void 0===r&&(r="OFF"),void 0===i&&(i="UPLOAD"),this.token=e,this.disableReport=n,this.level=r,this.prefix=i,this.id=++t.id}return t.prototype.getPrintPrefix=function(t){return"Qiniu-JS-SDK ["+t+"]["+this.prefix+"#"+this.id+"]:"},t.prototype.report=function(t,e){if(!this.disableReport)try{Gt(this.token,t,e)}catch(n){this.warn(n)}},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=["INFO"];n.includes(this.level)&&console.log.apply(console,Kt([this.getPrintPrefix("INFO")],t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=["INFO","WARN"];n.includes(this.level)&&console.warn.apply(console,Kt([this.getPrintPrefix("WARN")],t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=["INFO","WARN","ERROR"];n.includes(this.level)&&console.error.apply(console,Kt([this.getPrintPrefix("ERROR")],t))},t.id=0,t}(),Xt=Jt,$t=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},Qt=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},Yt=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},Zt=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(Yt(arguments[e]));return t},te=new Map,ee=function(){function t(t,e){this.host=t,this.protocol=e}return t.prototype.isFrozen=function(){var t=(new Date).getTime(),e=te.get(this.host);return null!=e&&e>=t},t.prototype.freeze=function(t){void 0===t&&(t=20);var e=(new Date).getTime()+1e3*t;te.set(this.host,e)},t.prototype.unfreeze=function(){te["delete"](this.host)},t.prototype.getUrl=function(){return this.protocol+"://"+this.host},t.prototype.getUnfreezeTime=function(){return te.get(this.host)},t}(),ne=function(){function t(t){void 0===t&&(t=[]),this.initHosts=t,this.cachedHostsMap=new Map}return t.prototype.register=function(t,e,n,r){this.cachedHostsMap.set(t+"@"+e,n.map((function(t){return new ee(t,r)})))},t.prototype.refresh=function(t,e,n){var r,i,o,a;return $t(this,void 0,void 0,(function(){var s,u,c;return Qt(this,(function(l){switch(l.label){case 0:return s=this.cachedHostsMap.get(t+"@"+e)||[],s.length>0?[2]:this.initHosts.length>0?(this.register(t,e,this.initHosts,n),[2]):[4,pt(t,e,n)];case 1:return u=l.sent(),null!=(null===u||void 0===u?void 0:u.data)&&(c=Zt((null===(i=null===(r=u.data.up)||void 0===r?void 0:r.acc)||void 0===i?void 0:i.main)||[],(null===(a=null===(o=u.data.up)||void 0===o?void 0:o.acc)||void 0===a?void 0:a.backup)||[]),this.register(t,e,c,n)),[2]}}))}))},t.prototype.getUp=function(t,e,n){return $t(this,void 0,void 0,(function(){var r,i,o;return Qt(this,(function(a){switch(a.label){case 0:return[4,this.refresh(t,e,n)];case 1:return a.sent(),r=this.cachedHostsMap.get(t+"@"+e)||[],0===r.length?[2,null]:(i=r.filter((function(t){return!t.isFrozen()})),i.length>0?[2,i[0]]:(o=r.slice().sort((function(t,e){return(t.getUnfreezeTime()||0)-(e.getUnfreezeTime()||0)})),[2,o[0]]))}}))}))},t}();function re(t,e,n,r){return t.config&&t.config.forceDirect?(r.info("ues forceDirect mode."),new Vt(t,e,n,r)):t.file.size>4*D?(r.info("file size over 4M, use Resume."),new Tt(t,e,n,r)):(r.info("file size less or equal than 4M, use Direct."),new Vt(t,e,n,r))}function ie(t,e,n,r,i){var o=new Xt(n,null===i||void 0===i?void 0:i.disableStatisticsReport,null===i||void 0===i?void 0:i.debugLogLevel,t.name),a={file:t,key:e,token:n,putExtra:r,config:ce(i,o)},s=new ne(a.config.uphost);return new S((function(t){var e=re(a,{onData:function(e){return t.next(e)},onError:function(e){return t.error(e)},onComplete:function(e){return t.complete(e)}},s,o);return e.putFile(),e.stop.bind(e)}))}var oe=function(){return oe=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},oe.apply(this,arguments)},ae=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},se=function(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{while((void 0===e||e-- >0)&&!(r=o.next()).done)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o["return"])&&n.call(o)}finally{if(i)throw i.error}}return a},ue=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(se(arguments[e]));return t};function ce(t,e){var n=oe({},t),r=n.upprotocol,i=n.uphost,o=ae(n,["upprotocol","uphost"]),a=oe({uphost:[],retryCount:3,checkByMD5:!1,forceDirect:!1,useCdnDomain:!0,checkByServer:!1,concurrentRequestLimit:3,chunkSize:Ct,upprotocol:"https",debugLogLevel:"OFF",disableStatisticsReport:!1},o);r&&(a.upprotocol=r.replace(/:$/,""));var s=[];if(e&&null!=(null===t||void 0===t?void 0:t.uphost)&&null!=(null===t||void 0===t?void 0:t.region)&&e.warn("do not use both the uphost and region config."),i)Array.isArray(i)?s.push.apply(s,ue(i)):s.push(i);else if(null===a||void 0===a?void 0:a.region){var u=ut[null===a||void 0===a?void 0:a.region];a.useCdnDomain?s.push.apply(s,ue(u.cdnUphost)):s.push.apply(s,ue(u.srcUphost))}return oe(oe({},a),{uphost:s.filter(Boolean)})}var le=function(){return le=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},le.apply(this,arguments)},he=function(t,e,n,r){function i(t){return t instanceof n?t:new n((function(e){e(t)}))}return new(n||(n=Promise))((function(n,o){function a(t){try{u(r.next(t))}catch(e){o(e)}}function s(t){try{u(r["throw"](t))}catch(e){o(e)}}function u(t){t.done?n(t.value):i(t.value).then(a,s)}u((r=r.apply(t,e||[])).next())}))},fe=function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(t){return function(e){return u([t,e])}}function u(o){if(n)throw new TypeError("Generator is already executing.");while(a)try{if(n=1,r&&(i=2&o[0]?r["return"]:o[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!(i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}},pe={PNG:"image/png",JPEG:"image/jpeg",WEBP:"image/webp",BMP:"image/bmp"},de=4,ge=Math.log(2),ye=Object.keys(pe).map((function(t){return pe[t]})),ve=pe.JPEG;function be(t){return ye.includes(t)}var me=function(){function t(t,e){this.file=t,this.config=e,this.config=le({quality:.92,noCompressIfLarger:!1},this.config)}return t.prototype.process=function(){return he(this,void 0,void 0,(function(){var t,e,n,r,i,o;return fe(this,(function(a){switch(a.label){case 0:if(this.outputType=this.file.type,t={},!be(this.file.type))throw new w(y.UnsupportedFileType,"unsupported file type: "+this.file.type);return[4,this.getOriginImage()];case 1:return e=a.sent(),[4,this.getCanvas(e)];case 2:return n=a.sent(),r=1,this.config.maxWidth&&(r=Math.min(1,this.config.maxWidth/n.width)),this.config.maxHeight&&(r=Math.min(1,r,this.config.maxHeight/n.height)),t.width=n.width,t.height=n.height,[4,this.doScale(n,r)];case 3:return i=a.sent(),o=this.toBlob(i),o.size>this.file.size&&this.config.noCompressIfLarger?[2,{dist:this.file,width:t.width,height:t.height}]:[2,{dist:o,width:i.width,height:i.height}]}}))}))},t.prototype.clear=function(t,e,n){this.outputType===ve?(t.fillStyle="#fff",t.fillRect(0,0,e,n)):t.clearRect(0,0,e,n)},t.prototype.getOriginImage=function(){var t=this;return new Promise((function(e,n){var r=at(t.file),i=new Image;i.onload=function(){e(i)},i.onerror=function(){n("image load error")},i.src=r}))},t.prototype.getCanvas=function(t){var e=this;return new Promise((function(n,r){var i=document.createElement("canvas"),o=i.getContext("2d");if(o){var a=t.width,s=t.height;i.height=s,i.width=a,e.clear(o,a,s),o.drawImage(t,0,0),n(i)}else r(new w(y.GetCanvasContextFailed,"context is null"))}))},t.prototype.doScale=function(t,e){return he(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,h,f,p,d,g,v,b;return fe(this,(function(m){if(1===e)return[2,t];if(n=t.getContext("2d"),r=Math.min(de,Math.ceil(1/e/ge)),i=Math.pow(e,1/r),o=document.createElement("canvas"),a=o.getContext("2d"),s=t.width,u=t.height,c=s,l=u,o.width=s,o.height=u,!a||!n)throw new w(y.GetCanvasContextFailed,"mctx or sctx can't be null");for(p=0;p<r;p++)d=s*i|0,g=u*i|0,p===r-1&&(d=c*e,g=l*e),p%2===0?(h=t,f=a):(h=o,f=n),this.clear(f,s,u),f.drawImage(h,0,0,s,u,0,0,d,g),s=d,u=g;return v=h===t?o:t,b=f.getImageData(0,0,s,u),v.width=s,v.height=u,f.putImageData(b,0,0),[2,v]}))}))},t.prototype.toBlob=function(t){var e=t.toDataURL(this.outputType,this.config.quality),n=atob(e.split(",")[1]).split("").map((function(t){return t.charCodeAt(0)})),r=new Blob([new Uint8Array(n)],{type:this.outputType});return r},t}(),we=function(t,e){return new me(t,e).process()},ke=we;var Oe={data:function(){return{tags:["动漫","人物","景色","摄影","影视","唯美","游戏","宠物","植物","森林","天空"],tags_flag:[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],currentTag:[],fileList:[],current_item:"",show:!1,control:!1,current_file:"",formData:{fileName:"",tags:"",uid:""}}},methods:{addTag:function(t){if(this.tags_flag[t]){var e=this.currentTag.indexOf(this.tags[t]);this.currentTag.splice(e,1),this.tags_flag[t]=!1}else this.currentTag.push(this.tags[t]),this.tags_flag[t]=!0},showPopup:function(){this.show=!0,this.control=!0},onOversize:function(t){console.log("图片大小不能超过10m")},close:function(){this.control&&""!=this.current_item&&(this.tags.push(this.current_item),this.current_item="",this.control=!1)},afterRead:function(t){this.current_file=t,console.log(t)},back:function(){this.$router.push("/home")},upload:function(){for(var t=this,e="",n=this.currentTag.length,r=0;r<n;r++)r!=n-1?e=e+this.currentTag[r]+"/":e+=this.currentTag[r];this.formData.fileName=this.fileList[0].file.name,this.formData.tags=e,this.formData.uid=1;var i=JSON.stringify(this.formData);this.fileList[0];b()({headers:{"Content-Type":"application/json;charset=UTF-8"},method:"post",url:"http://42.240.141.211/WallpaperController/insertUserWallpaper",dataType:"json",contentType:"application/json",data:i}).then((function(e){if("图片上传失败"==e.data)alert("图片上传失败");else{var n={next:function(t){},error:function(t){alert("上传错误")},complete:function(t){}};t.img=e.data;var r={useCdnDomain:!0,upprotocol:"http"},i={fname:t.img.src.split("/").slice(-1)[0]},o={fname:t.img.sm_src.split("/").slice(-1)[0]},a=ie(t.fileList[0].file,t.img.src.split("/").slice(-1)[0],e.data.token,i,r),s=(a.subscribe(n),{quality:.82,noCompressIfLarger:!0,maxWidth:720,maxHeight:560});ke(t.fileList[0].file,s).then((function(i){var a=ie(i.dist,t.img.sm_src.split("/").slice(-1)[0],e.data.token,o,r);a.subscribe(n)})),alert("上传成功")}}))}},created:function(){this.$store.state.toucherShow=!1},destroyed:function(){this.$store.state.toucherShow=!0}},je=(n("6e8d"),n("6b0d")),Ce=n.n(je);const _e=Ce()(Oe,[["render",g],["__scopeId","data-v-3d8e8f7a"]]);e["default"]=_e},"91dd":function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!==typeof t||0===t.length)return a;var s=/\+/g;t=t.split(e);var u=1e3;o&&"number"===typeof o.maxKeys&&(u=o.maxKeys);var c=t.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var h,f,p,d,g=t[l].replace(s,"%20"),y=g.indexOf(n);y>=0?(h=g.substr(0,y),f=g.substr(y+1)):(h=g,f=""),p=decodeURIComponent(h),d=decodeURIComponent(f),r(a,p)?i(a[p])?a[p].push(d):a[p]=[a[p],d]:a[p]=d}return a};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},ade3:function(t,e,n){"use strict";function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}n.d(e,"a",(function(){return r}))},b383:function(t,e,n){"use strict";e.decode=e.parse=n("91dd"),e.encode=e.stringify=n("e099")},bae9:function(t,e,n){},c53e:function(t,e,n){"use strict";n("bae9")},e099:function(t,e,n){"use strict";var r=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,n,s){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"===typeof t?o(a(t),(function(a){var s=encodeURIComponent(r(a))+n;return i(t[a])?o(t[a],(function(t){return s+encodeURIComponent(r(t))})).join(e):s+encodeURIComponent(r(t[a]))})).join(e):s?encodeURIComponent(r(s))+n+encodeURIComponent(r(t)):""};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function o(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var a=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}}}]);
//# sourceMappingURL=uploadGroup.2880f99e.js.map